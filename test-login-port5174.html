<!doctype html>
<html>
  <head>
    <title>Test Login from Port 5174</title>
  </head>
  <body>
    <h1>Testing Login on Port 5174</h1>
    <div id="output"></div>

    <script>
      const API_BASE = '/api'; // Using relative path like the frontend

      async function testLogin() {
        const testUser = {
          username: 'testuser_915656', // Using our existing test user
          password: 'TestPassword123!',
        };

        try {
          console.log('Testing login...');
          const response = await fetch(`${API_BASE}/auth/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(testUser),
          });

          const data = await response.json();
          console.log('Response:', data);

          document.getElementById('output').innerHTML = `
                    <h3>Status: ${response.status}</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;

          if (response.ok && data.data?.token) {
            localStorage.setItem('letschat_token', data.data.token);
            console.log('Login successful, token stored');
          }
        } catch (error) {
          console.error('Login error:', error);
          document.getElementById('output').innerHTML = `
                    <h3>Error: ${error.message}</h3>
                `;
        }
      }

      testLogin();
    </script>
  </body>
</html>
